---
title: "Multivariate Assignment - 1 v1"
author: "Elena Ortega - Damiano Alessi - Xieru Song - Aharon V. Zúñiga."
date: "October - 2020"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
editor_options: 
chunk_output_type: console
---


```{r setup, include=FALSE}
library(maptools)
library(dplyr)
library(Matrix.utils)
library(ggplot2)
library(lavaan)
library(candisc)
library(semTools)
library(semPlot)
library(knitr)
library(tables)
knitr::opts_chunk$set(echo = TRUE)
```

# [Exploratory factor analysis (EFA)] 
## Global function
```{r step_}
zscore <- function(x) {
  zscore <- (x-mean(x))/sd(x)
  } 
```
## Loading Data
```{r step_0}
load("wvs.Rdata")
```
## Checking data

```{r step_1}
summary(wvs[,1:10])
```

## Explanation 

First of all, I create zjustif as a variable to work whit and tranform it into favm_justif2. 
Im going to use 4 factors.

```{r p2_step_1 }
zjustif <- apply(wvs[,16:29],2,zscore)
favm_justif2 <- factanal(zjustif,factors=4, rotation="varimax") #Varimax 
```

After that, is possible to see the loadings, and Factor 2 and Factor 4 have the same variables, in fact, the 4th factor is using a __copy__ of those. 

```{r p2_step_2 }
print(favm_justif2$loadings, digits = 2, cutoff = 0.4, sort = TRUE)
```

But, here is when is necessary to consider the criteria. 
  * ¿Are both factor has enough difference in order to split it?
  * Conceptually ¿Is __J_avoiding_fare__ too different than __J_cheating_taxes__? 
  * ¿Are the loadings higer for those variables in __factor 4__ than __factor 3__?

Lastly, if the variance is checked, is also possible to see the importance of the three first factors than the 4th., 

```{r p2_step_3 }
pjustif<-prcomp(zjustif)
screeplot(pjustif,type="lines")
abline(h = 1, v = NULL, col = "red")
```


